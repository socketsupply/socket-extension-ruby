[build]
name = "socket-ruby-extension-example"
output = "build"
copy = "src"
flags = -O3
script = sh scripts/build-mruby.sh

env[] = USER
env[] = HOME
env[] = TMPDIR
env[] = PWD

[build.extensions]
ruby[] = extensions/include/ruby.h
ruby[] = extensions/src/bindings.cc
ruby[] = extensions/src/ipc.cc
ruby[] = extensions/src/kernel.cc
ruby[] = extensions/src/migrate.cc
ruby[] = extensions/src/ruby.cc
ruby[] = extensions/src/state.cc
ruby[] = extensions/src/types.cc

[build.extensions.ruby.configure]
script = "sh scripts/configure.sh"

[build.extensions.ruby.compiler]
flags[] = -Imruby/include
flags[] = -Iextensions/include

[build.extensions.ruby.ios.linker]
flags[] = -framework Security,CoreFoundation,CoreBluetooth,ObjC

[build.extensions.ruby.mac.linker]
flags[] = -framework Security,CoreFoundation,CoreBluetooth,ObjC

[debug]
flags = "-g"

[meta]
title = "Socket - Native Ruby Extension Example"
description = "An example of an extension written in Ruby"
version = 1.0.0
maintainer = "Socket Supply, Co."
copyright = "(C) Socket Supply, Co. 2023"
lang = "en-us"

[meta.bundle]
identifier = "co.socketsupply.ruby.example"

[meta.file]
limit = 1024

[ios.distribution]
method = "development"

[ios.simulator]
device = "iPhone 14"
